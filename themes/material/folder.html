{% extends "base.html" %}

{% macro render_assets(assets) %}
  {% for group in assets|groupby('basename') %}
    <li>
      <div><img src="{{group.list[0].thumbnail_url}}"></div>
      {% for asset in group.list %}
        <a href="{{asset.url}}">{{asset.title}}</a> ({{asset.size|filesizeformat}})</li>
      {% endfor %}
    </li>
  {% endfor %}

{% endmacro %}

{% block main %}
  <h1>{{folder.title}}</h1>

  <ul class="toc">
    {% for f in folder.children['folders'] %}
      <li><a href="#{{f.slug}}">{{f.title}}</a></li>
    {% endfor %}
  </ul>

  {% for f in folder.children['folders'] %}
    <h3 id="{{f.slug}}">{{f.title}}</h3>
    {{render_assets(f.children['assets'])}}
  {% endfor %}

  {{render_assets(folder.children['assets'])}}

{% endblock %}
