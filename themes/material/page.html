{% if page.parent and page.parent.is_overview_folder %}
  {% set title = page.title %}
{% else %}
  {% set title = '{} â€º {}'.format(page.parent.title, page.title) %}
{% endif %}
{% extends "base.html" %}

{% block main %}
  <div class="page contained">
    {% block main_content %}
      <h1>{{page.title}}</h1>
      <div class="page-document">
        {{pretty_html|safe}}
      </div>
    {% endblock %}
  </div>
  {% if is_admin %}
    {{macros.render_admin_bar(page)}}
  {% endif %}
  <script>
    $('.page-document > table').each(function(i, table) {
      var $table = $(table);
      if ($table) {
        var numCols = $(this).find('> tbody > tr:first-child > td').size();
        if ($table.attr('class').indexOf('page-document-table') < 0) {
          $(this).addClass('cols-' + numCols);
        }
      }
    });

    var buildToc = function() {
      var tocEl = document.querySelector('.toc--auto ul');
      if (tocEl) {
        var els = document.querySelectorAll('h2');
        [].forEach.call(els, function(el, i) {
          var elId = 'toc-' + i;
          el.setAttribute('id', elId);
          var title = el.textContent;
          var listItemEl = $('<li><a data-scroll href="#' + elId + '">' + title + '</a></li>');
          $(tocEl).append(listItemEl);
        });
      }
    };
    buildToc();
  </script>
{% endblock %}

{% block footer %}
<div class="layout-main-footer">
  <div class="layout-main-footer-part">
    {% set prev = get_sibling(page or folder, next=false) %}
    {% if prev %}
      {% if prev.folder %}
        {% set prev = prev['folder'] %}
      {% endif %}
      <a href="{{prev.url}}">
        <span class="layout-main-footer-part-caption">Previous</span>
        <span><i class="material-icons arrow-R">arrow_backward</i> {{prev.title}}</span>
      </a>
    {% endif %}
  </div>
  <div class="layout-main-footer-part layout-main-footer-part--next">
    {% set next = get_sibling(page or folder, next=true) %}
    {% if next %}
      {% if next.folder %}
        {% set next = next['folder'] %}
      {% endif %}
      <a href="{{next.url}}">
        <span class="layout-main-footer-part-caption">Next</span>
        <span>{{next.title}} <i class="material-icons arrow-R">arrow_forward</i></span>
      </a>
    {% endif %}
  </div>
</div>
{% endblock %}
